upstream web {
    server unix:/var/run/php/php-fpm.sock;

    keepalive 20;
}

server {
    listen 80 default_server;
    listen [::]:80 default_server;

    root /home/kairat_ninety/rpctests/web/;
    index index.php;

    server_name _;

    location / {
        try_files $uri $uri/ =404;
    }

    location ~ \.php$ {
        include snippets/fastcgi-php.conf;
        fastcgi_pass unix:/run/php/php-fpm.sock;
    }

    location ~ /\.ht {
        deny all;
    }
}


# upstream web {
#     server unix:/var/run/php/php-fpm.sock;
#     keepalive 20;
# }
# server {
#     root /home/kairat_ninety/rpctests/web;
#     index index.php
#     server_name 34.66.39.240;
#     location ^~ /includes/ {
#         deny all;
#         return 403;
#     }
#     location ~ [^/]\.php(/|$) {
#         fastcgi_split_path_info ^(.+?\.php)(/.*)$;
#         if (!-f $document_root$fastcgi_script_name) {
#             return 404;
#         }
#         sendfile on;
#         tcp_nopush on;
#         # Mitigate https://httpoxy.org/ vulnerabilities
#         fastcgi_param HTTP_PROXY "";
#         fastcgi_pass web;
#         include snippets/fastcgi-php.conf;
#     }
#     location / {
#         try_files $uri $uri/ =404;
#     }
#     location ~ /\.ht {
#         deny all;
#     }
# }